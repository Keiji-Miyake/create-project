## モード管理

プロジェクトの状況に応じて適切なモードを選択し、効率的に作業を進めます。

### モードの種類と役割

| モード             | スラッグ        | 用途                                       | 書き込み権限       |
| ---------------- | --------------- | ------------------------------------------ | ------------------ |
| Ask              | `ask`           | 質問応答、情報提供、分析、設計支援         | 不可               |
| Code             | `code`          | コードの記述、編集、リファクタリング       | 全ファイル         |
| Debug            | `debug`         | バグの特定、原因分析、修正案の提示         | 制限あり           |
| コードレビュワー | `reviewer`      | コードレビュー、品質評価                   | 不可               |
| システムアーキテクト | `architect`     | システム設計、アーキテクチャ提案           | `.md` ファイルのみ |
| ドキュメント専門家 | `documentation` | ドキュメント作成、更新                     | 主に `.md` ファイル |
| セキュリティ専門家 | `security`      | 脆弱性分析、セキュリティレビュー           | 不可               |
*(利用可能なモードは変更される可能性があります)*

### モデル選択の指針

#### タスク種類による選択
| タスク種類           | 推奨モデル          | 理由                                     |
| ------------------- | ------------------- | ---------------------------------------- |
| コード生成           | default            | 高い型安全性と豊富なコンテキスト理解が必要 |
| バグ修正             | Gemini2.5Pro       | 論理的な問題解決と具体的な修正案の提示に強い |
| リファクタリング     | default            | 大規模なコードベースの理解と改善に優れる |
| ドキュメント作成     | DeepSeek           | 技術文書の構造化と明確な説明が得意      |
| コードレビュー       | default            | 詳細な分析と具体的な改善提案が可能      |
| 質問応答             | Gemini2.5Pro       | 迅速で正確な応答と豊富な知識ベース      |

#### コンテキストサイズによる選択
| コンテキストサイズ   | 推奨モデル          | 考慮事項                                 |
| ------------------- | ------------------- | ---------------------------------------- |
| 〜4K tokens         | Gemini2.5Pro       | 迅速な応答、効率的な処理                 |
| 4K〜8K tokens       | default            | バランスの取れた性能とコンテキスト理解   |
| 8K tokens〜         | DeepSeek           | 大規模なコンテキスト処理に適している     |

### セッション管理

#### 1セッション1タスクの原則
- 1つのセッションでは1つのタスクのみを実行
- 複数の関連タスクは別セッションに分割
- セッション間の依存関係を明確に記録
- コンテキストの混在を防止

#### コンテキスト管理
1. **セッション開始時:**
   - タスクの範囲を明確に定義
   - 必要なコンテキストを特定
   - メモリーバンクの関連ファイルを確認
   - 前提条件の検証

2. **セッション中:**
   - コンテキストの一貫性を維持
   - 重要な判断は記録
   - 進捗状況を `activeContext.md` に更新
   - 発見した知見を文書化

3. **セッション終了時:**
   - 成果物の確認
   - メモリーバンクの更新
   - 次のセッションへの引継事項を記録
   - フィードバックの整理

4. **セッション間の引継ぎ:**
   - `.md` ファイルを介して情報を伝達
   - 重要な文脈は明示的に記録
   - 依存関係を図示
   - 未解決の課題を列挙

### モード固有の指示

-   モード固有のルールや指示は、以下のいずれかの方法で設定できます。
    1.  **UI設定:** Roo Code/Cline の設定画面から、各モードに対してカスタムインストラクションを追加します。
    2.  **ルールファイル:** ワークスペースルートに `.clinerules-[mode_slug]` という形式のファイルを作成します (例: `.clinerules-code`, `.clinerules-debug`)。
-   両方が設定されている場合、両方の指示が適用されます。モード固有のルールは、グローバルな `.clinerules` を補完します。

### モード切替の判断基準

-   現在のモードでタスクの目的を達成できない場合、適切なモードへの切り替えを検討します。
-   **例:**
    -   `ask` モードで分析後、コード変更が必要になった場合 → `code` モードへ切り替えを提案します。
    -   コード編集中に複雑なデバッグが必要になった場合 → `debug` モードへの切り替えを検討します。
    -   設計に関する議論が必要な場合 → `architect` モードへの切り替えを検討します。
-   モード切り替えは `switch_mode` ツールを使用し、理由を明記してください。